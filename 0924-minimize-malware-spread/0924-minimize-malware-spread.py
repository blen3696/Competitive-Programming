class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        visited = [False] * n
        com_id = [-1] * n

        def bfs(node, c_id):
            stack = [node]
            visited[node] = True
            com_id[node] = c_id
            com_l = 1

            while stack:
                u = stack.pop()
                for v in range(n):
                    if graph[u][v] == 1 and not visited[v]:
                        visited[v] = True
                        com_id[v] = c_id
                        stack.append(v)
                        com_l += 1

            return com_l

        
        com_infected = []
        com_size = []

        c_id = 0

        for node in range(n):
            if not visited[node]:
                size = bfs(node, c_id)
                com_size.append(size)
                com_infected.append(0)
                c_id += 1

        
        for node in initial:
            com_infected[com_id[node]] += 1

        initial.sort()

        max_saved = 0
        res = initial[0]

        for node in initial:
            c_id = com_id[node]
            if com_infected[c_id] == 1:
                if com_size[c_id] > max_saved:
                    max_saved = com_size[c_id]
                    res = node
                elif com_size[c_id] == max_saved:
                    res = min(res, node)

        return res 



            



            

        

            
        
